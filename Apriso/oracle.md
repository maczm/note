# 1、扩展表模版

```sql
/*
    表中文名称：XXXXXX
    表功能概要：XXXXXX
*/
--DROP SEQUENCE FLXUSER.SEQ_XXXXXX;
CREATE SEQUENCE FLXUSER.SEQ_XXXXXX MINVALUE 100000000 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 100000000 CACHE 20 NOORDER NOCYCLE NOKEEP  NOSCALE  GLOBAL;

-- TABLE STRUCTURE FOR FLXUSER.XXXXXX
------------------------------
--DROP TABLE FLXUSER.XXXXXX;
CREATE TABLE FLXUSER.XXXXXX
(
    ID                NUMBER                 NOT NULL, --主键
    Field             NVARCHAR2(36)          NULL,     --自定义字段
    --系统必需字段
    TEXTID            NUMBER                 NULL,
    UNITID            NUMBER                 NULL,
    REFERENCEID       NUMBER                 NULL,
    LASTUPDATEON      DATE                   NULL,
    LASTUPDATEDBY     NVARCHAR2(50)          NULL,
    CREATEDON         DATE                   NULL,
    CREATEDBY         NVARCHAR2(50)          NULL,
    ACTIVE            NUMBER(1)    DEFAULT 1 NOT NULL,
    LASTDELETEON      DATE                   NULL,
    LASTDELETEDBY     NVARCHAR2(50)          NULL,
    LASTREACTIVATEON  DATE                   NULL,
    LASTREACTIVATEDBY NVARCHAR2(50)          NULL,
    ARCHIVEID         NUMBER                 NULL,
    LASTARCHIVEON     DATE                   NULL,
    LASTARCHIVEDBY    NVARCHAR2(50)          NULL,
    LASTRESTOREON     DATE                   NULL,
    LASTRESTOREDBY    NVARCHAR2(50)          NULL,
    ROWVERSIONSTAMP   NUMBER(38)   DEFAULT 1 NULL
);
CREATE UNIQUE INDEX IDX_FLXUSER_XXXXXX_ID ON FLXUSER.XXXXXX (ID);
COMMENT ON COLUMN FLXUSER.XXXXXX.ID IS '主键';
COMMENT ON COLUMN FLXUSER.XXXXXX.Field IS '自定义字段';
--系统必需字段
COMMENT ON COLUMN FLXUSER.XXXXXX.TEXTID IS '达索标准字段：多语言表ID';
COMMENT ON COLUMN FLXUSER.XXXXXX.UNITID IS '达索标准字段：UNIT表ID';
COMMENT ON COLUMN FLXUSER.XXXXXX.REFERENCEID IS '达索标准字段：REFERENCEID ';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTUPDATEON IS '达索标准字段：最后更新时间';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTUPDATEDBY IS '达索标准字段：最后更新人';
COMMENT ON COLUMN FLXUSER.XXXXXX.CREATEDON IS '达索标准字段：创建时间';
COMMENT ON COLUMN FLXUSER.XXXXXX.CREATEDBY IS '达索标准字段：创建人';
COMMENT ON COLUMN FLXUSER.XXXXXX.ACTIVE IS '达索标准字段：激活状态';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTDELETEON IS '达索标准字段：最后删除时间';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTDELETEDBY IS '达索标准字段：最后删除人';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTREACTIVATEON IS '达索标准字段：最后重激活时间';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTREACTIVATEDBY IS '达索标准字段：最后重激活人';
COMMENT ON COLUMN FLXUSER.XXXXXX.ARCHIVEID IS '达索标准字段：ARCHIVE_表ID';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTARCHIVEON IS '达索标准字段：最后归档时间';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTARCHIVEDBY IS '达索标准字段：最后归档人';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTRESTOREON IS '达索标准字段：最后修复时间';
COMMENT ON COLUMN FLXUSER.XXXXXX.LASTRESTOREDBY IS '达索标准字段：最后修复人';
COMMENT ON COLUMN FLXUSER.XXXXXX.ROWVERSIONSTAMP IS '达索标准字段：行变更次数';

ALTER TABLE FLXUSER.XXXXXX
    ADD CONSTRAINT SYS_FLXUSER_XXXXXX_PK PRIMARY KEY (ID);

-- Checks structure for table FLXUSER.XXXXXX
-- ----------------------------
ALTER TABLE FLXUSER.XXXXXX
    ADD CONSTRAINT SYS_FLXUSER_XXXXXX_ID CHECK (ID IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE FLXUSER.XXXXXX
    ADD CONSTRAINT SYS_FLXUSER_XXXXXX_ACTIVE CHECK (ACTIVE IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
-- ----------------------------
-- Triggers structure for table FLXUSER.XXXXXX
-- ----------------------------
CREATE OR REPLACE TRIGGER FLXUSER.INS_XXXXXX
    BEFORE INSERT
    ON FLXUSER.XXXXXX
    REFERENCING OLD AS OLD NEW AS NEW
    FOR EACH ROW
DECLARE
    i_LAST NUMBER;
BEGIN
    SELECT FLXUSER.SEQ_XXXXXX.NEXTVAL INTO i_LAST FROM Dual;
    PKG_IDENTITY.SET_IDENTITY(i_LAST);
    :NEW.ID := i_LAST;
END;

--GRANT USER
GRANT SELECT ON FLXUSER.XXXXXX TO APP_READER_FLXUSER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FLXUSER.XXXXXX TO APP_WRITER_FLXUSER;
```

# 2、新增单据类型

```sql
INSERT INTO TEXT
(Type, FUID, LastUpdateOn, LastUpdatedBy, CreatedOn, CreatedBy, Active, RowVersionStamp)
VALUES ('WIP_ORDER_TYPE', SYS_GUID(), SYSDATE, 'SYSTEM', SYSDATE, 'SYSTEM', 1, 1);

INSERT INTO TEXT_TRANSLATION
(TextID, LanguageID, Medium, LastUpdateOn, LastUpdatedBy, CreatedOn, CreatedBy, Active, RowVersionStamp)
VALUES ((SELECT MAX(ID) FROM TEXT), 2052, 'WMS拣配结果', SYSDATE, 'SYSTEM', SYSDATE, 'SYSTEM', 1, 1);

INSERT INTO WIP_ORDER_TYPE
(WipOrderType, TextID, LastUpdateOn, LastUpdatedBy, CreatedOn, CreatedBy, Active, RowVersionStamp)
VALUES (34, (SELECT MAX(ID) FROM TEXT), SYSDATE, 'SYSTEM', SYSDATE, 'SYSTEM', 1, 1);
```

# 3、解决锁表问题

```sql
-- 查询哪些对象被锁
SELECT object_name, machine, s.sid, s.serial#
  FROM v$locked_object l,
       dba_objects o,
       v$session s
 WHERE l.object_id = o.object_id
   AND l.session_id = s.sid;

-- 杀死一个进程
ALTER SYSTEM KILL SESSION '2505,15039';
```

# 4、修改实体状态

```sql
UPDATE OPERATION
SET RevisionStatusID = 4
WHERE OperationCode = 'LES_AutoSortTaskQuery.GridView';

UPDATE SF_LAYOUT
SET RevisionStatusID = 4
WHERE OperationCode = 'LES_AutoSortTaskQuery.GridView';;

UPDATE SF_SCREEN_REVISION
SET RevisionStatusID = 4
WHERE SCREENID = (SELECT ID
                  FROM FLXUSER.SF_VIEW
                  WHERE SF_VIEW.NAME = 'LES_AutoSortTaskQueryFilter.FormView');

UPDATE SF_VIEW_REVISION
SET RevisionStatusID = 4
WHERE VIEWID = (SELECT ID
                FROM FLXUSER.SF_VIEW
                WHERE SF_VIEW.NAME = 'LES_AutoSortTaskQueryFilter.FormView');
```

